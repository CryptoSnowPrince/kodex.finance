"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9173],{59173:function(e,t,r){r.d(t,{I:function(){return k},w:function(){return g}});var n=r(34051),a=r.n(n),o=r(62210),s=r(9669),i=r.n(s),c=r(26041),u=r(70794),l=r(19869),p=r(83108),v=r(9133),b=r(63139);function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function h(e,t,r,n,a,o,s){try{var i=e[o](s),c=i.value}catch(u){return void r(u)}i.done?t(c):Promise.resolve(c).then(n,a)}function d(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function s(e){h(o,n,a,s,i,"next",e)}function i(e){h(o,n,a,s,i,"throw",e)}s(void 0)}))}}function m(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){m(e,t,r[t])}))}return e}function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o=[],s=!0,i=!1;try{for(r=r.call(e);!(s=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);s=!0);}catch(c){i=!0,a=c}finally{try{s||null==r.return||r.return()}finally{if(i)throw a}}return o}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return f(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var k=function(){var e=d(a().mark((function e(t,r){var n,s,p,f,h,d,m,w,y,k,x,g,D,S,B,V,E,P,A,j,T,_,N,q,I,M,C,R,X,Y,Z,H,L,K,U,$,z,F,G,J,Q,W,ee,te,re,ne,ae,oe,se,ie,ce,ue,le,pe,ve,be,fe,he,de,me,we,ye,ke,xe,Oe,ge,De,Se,Be;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=o.h.getState(),s=n.config.AMMs,p=n.config.tokens,e.next=6,i().get("".concat(c.Z.VE_INDEXER[v.Px],"bribes-provider?address=").concat(t));case 6:for(f=e.sent,h=f.data,d=[],m=new Map,w=!0,y=!1,k=void 0,e.prev=11,x=h[Symbol.iterator]();!(w=(g=x.next()).done);w=!0)D=g.value,S=D.amm+"_"+D.epoch+"_"+D.name,m.has(S)?(B=m.get(S),V=B.value.plus(new u.O(D.value)),m.set(S,{value:V,price:B.price})):m.set(S,{value:new u.O(D.value),price:Number(D.price)});e.next=19;break;case 15:e.prev=15,e.t0=e.catch(11),y=!0,k=e.t0;case 19:e.prev=19,e.prev=20,w||null==x.return||x.return();case 22:if(e.prev=22,!y){e.next=25;break}throw k;case 25:return e.finish(22);case 26:return e.finish(19);case 27:for(E=[],P=!0,A=!1,j=void 0,e.prev=29,T=m.entries()[Symbol.iterator]();!(P=(_=T.next()).done);P=!0)N=_.value,q=N[0].split("_"),E.push({value:N[1].value.toString(),name:q[2],amm:q[0],epoch:q[1],price:N[1].price.toString()});e.next=37;break;case 33:e.prev=33,e.t1=e.catch(29),A=!0,j=e.t1;case 37:e.prev=37,e.prev=38,P||null==T.return||T.return();case 40:if(e.prev=40,!A){e.next=43;break}throw j;case 43:return e.finish(40);case 44:return e.finish(37);case 45:for(I=new Map,M=!0,C=!1,R=void 0,e.prev=47,X=E[Symbol.iterator]();!(M=(Y=X.next()).done);M=!0)Z=Y.value,H=Z.value+"_"+Z.name+"_"+Z.amm+"_"+Z.price,I.has(H)?((L=I.get(H)).push(Number(Z.epoch)),L.sort((function(e,t){return e-t})),I.set(H,L)):I.set(H,[Number(Z.epoch)]);e.next=55;break;case 51:e.prev=51,e.t2=e.catch(47),C=!0,R=e.t2;case 55:e.prev=55,e.prev=56,M||null==X.return||X.return();case 58:if(e.prev=58,!C){e.next=61;break}throw R;case 61:return e.finish(58);case 62:return e.finish(55);case 63:K=[],U=!0,$=!1,z=void 0,e.prev=65,F=I.entries()[Symbol.iterator]();case 67:if(U=(G=F.next()).done){e.next=90;break}for(J=G.value,Q=O(J[1]),W=!0,ee=!1,te=void 0,e.prev=71,re=Q[Symbol.iterator]();!(W=(ne=re.next()).done);W=!0)ae=ne.value,K.push({key:J[0],value:ae});e.next=79;break;case 75:e.prev=75,e.t3=e.catch(71),ee=!0,te=e.t3;case 79:e.prev=79,e.prev=80,W||null==re.return||re.return();case 82:if(e.prev=82,!ee){e.next=85;break}throw te;case 85:return e.finish(82);case 86:return e.finish(79);case 87:U=!0,e.next=67;break;case 90:e.next=96;break;case 92:e.prev=92,e.t4=e.catch(65),$=!0,z=e.t4;case 96:e.prev=96,e.prev=97,U||null==F.return||F.return();case 99:if(e.prev=99,!$){e.next=102;break}throw z;case 102:return e.finish(99);case 103:return e.finish(96);case 104:return e.next=106,(0,l.Kc)(10);case 106:oe=e.sent,se=oe.epochData,ie=!0,ce=!1,ue=void 0,e.prev=109,le=K[Symbol.iterator]();case 111:if(ie=(pe=le.next()).done){e.next=133;break}return ve=pe.value,be=ve.key.split("_"),fe=s[be[2]],de=new u.O(be[0]).dividedBy(new u.O(10).pow(p[be[1]].decimals)).multipliedBy(null!==(he=r[be[1]])&&void 0!==he?he:0),me=ve.value,we=me[0],ye=me[me.length-1],e.next=122,(0,l.Y3)(we);case 122:ke=e.sent,xe=ke.epochData,Oe=void 0,se[we]?(Oe=se[we].epochStartTimestamp/1e3,de=new u.O(be[0]).dividedBy(new u.O(10).pow(p[be[1]].decimals)).multipliedBy(null!==(ge=r[be[1]])&&void 0!==ge?ge:0)):(Oe=xe.epochStartTimestamp,de=new u.O(be[0]).dividedBy(new u.O(10).pow(p[be[1]].decimals)).multipliedBy(Number(be[3]))),De="testnet"===v.Px?b.Lx/1e3:b.wB/1e3,Se=Oe+De*me.length,Be=de.multipliedBy(ve.value.length),d.push({ammAddress:fe.address,tokenA:fe.token1.symbol,tokenB:fe.token2.symbol,poolType:fe.type,bribeValue:Be,bribeValuePerEpoch:de,bribeToken:be[1],epochStart:we,epochEnd:ye,epochStartDate:Oe,epochEndDate:Se});case 130:ie=!0,e.next=111;break;case 133:e.next=139;break;case 135:e.prev=135,e.t5=e.catch(109),ce=!0,ue=e.t5;case 139:e.prev=139,e.prev=140,ie||null==le.return||le.return();case 142:if(e.prev=142,!ce){e.next=145;break}throw ue;case 145:return e.finish(142);case 146:return e.finish(139);case 147:return e.abrupt("return",{success:!0,userBribesData:d});case 150:return e.prev=150,e.t6=e.catch(0),console.log(e.t6),e.abrupt("return",{success:!1,userBribesData:[],error:e.t6.message});case 154:case"end":return e.stop()}}),e,null,[[0,150],[11,15,19,27],[20,,22,26],[29,33,37,45],[38,,40,44],[47,51,55,63],[56,,58,62],[65,92,96,104],[71,75,79,87],[80,,82,86],[97,,99,103],[109,135,139,147],[140,,142,146]])})));return function(t,r){return e.apply(this,arguments)}}(),x=function(){var e=d(a().mark((function e(t,r){var n,s,p,b,f,h,d,m,y,k,x,O,g,D,S,B,V,E,P,A,j,T,_,N,q,I,M,C,R;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=o.h.getState(),s=n.config.tokens,e.next=5,i().get("".concat(c.Z.VE_INDEXER[v.Px],"bribes?epoch=").concat(t));case 5:return p=e.sent,b=p.data,e.next=9,(0,l.Y3)(t);case 9:if(!(f=e.sent).success){e.next=19;break}return d=f.epochData,e.next=15,i().get("".concat(c.Z.ANALYTICS_INDEXER[v.Px],"ve/pools?ts=").concat(d.epochEndTimestamp-1));case 15:m=e.sent,h=m.data,e.next=20;break;case 19:throw new Error(f.error);case 20:y=h.reduce((function(e,t){return e[t.pool]=t,e}),{}),k={},x=!0,O=!1,g=void 0,e.prev=23,D=b[Symbol.iterator]();case 25:if(x=(S=D.next()).done){e.next=60;break}if(B=S.value,V=new u.O(0),E=[],P={},B.bribes&&0!==B.bribes.length){e.next=34;break}V=new u.O(0),e.next=52;break;case 34:for(A=!0,j=!1,T=void 0,e.prev=35,_=B.bribes[Symbol.iterator]();!(A=(N=_.next()).done);A=!0)q=N.value,V=V.plus(new u.O(q.value).dividedBy(new u.O(10).pow(s[q.name].decimals)).multipliedBy(r[q.name]||0)),P[q.name]?(I=P[q.name],P[q.name]=w({},I,{value:I.value.plus(new u.O(q.value).dividedBy(new u.O(10).pow(s[q.name].decimals))),price:I.price.plus(new u.O(q.value).dividedBy(new u.O(10).pow(s[q.name].decimals)).multipliedBy(r[q.name]||0))})):P[q.name]={name:q.name,value:new u.O(q.value).dividedBy(new u.O(10).pow(s[q.name].decimals)),price:new u.O(q.value).dividedBy(new u.O(10).pow(s[q.name].decimals)).multipliedBy(r[q.name]||0)};e.next=43;break;case 39:e.prev=39,e.t0=e.catch(35),j=!0,T=e.t0;case 43:e.prev=43,e.prev=44,A||null==_.return||_.return();case 46:if(e.prev=46,!j){e.next=49;break}throw T;case 49:return e.finish(46);case 50:return e.finish(43);case 51:E=Object.values(P);case 52:M=y[B.pool]?new u.O(y[B.pool].tvl.value):new u.O(0),C=y[B.pool]?new u.O(y[B.pool].tvl.token1):new u.O(0),R=y[B.pool]?new u.O(y[B.pool].tvl.token2):new u.O(0),E.length>0&&E.sort((function(e,t){return t.price.minus(e.price).toNumber()})),k[B.pool]={liquidity:M,bribes:V,bribesData:E,liquidityTokenA:C,liquidityTokenB:R};case 57:x=!0,e.next=25;break;case 60:e.next=66;break;case 62:e.prev=62,e.t1=e.catch(23),O=!0,g=e.t1;case 66:e.prev=66,e.prev=67,x||null==D.return||D.return();case 69:if(e.prev=69,!O){e.next=72;break}throw g;case 72:return e.finish(69);case 73:return e.finish(66);case 74:return e.abrupt("return",k);case 77:throw e.prev=77,e.t2=e.catch(0),console.log(e.t2),new Error(e.t2.message);case 81:case"end":return e.stop()}}),e,null,[[0,77],[23,62,66,74],[35,39,43,51],[44,,46,50],[67,,69,73]])})));return function(t,r){return e.apply(this,arguments)}}(),O=function(e){for(var t=1,r=[],n=1;n<=e.length;n++)if(n===e.length||e[n]-e[n-1]!=1){if(1===t)r.push([e[n-t]]);else{for(var a=[],o=e[n-t];o<=e[n-1];o++)a.push(o);r.push(a)}t=1}else t++;return r},g=function(){var e=d(a().mark((function e(t,r){var n,s,i,c,l,v,b,f,h,d,m,w,k,O;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=o.h.getState(),s=n.config.AMMs,e.t0=y,e.next=6,Promise.all([x(t,r),(0,p.Hs)(t,void 0),(0,p.Hs)(t-1,void 0)]);case 6:if(e.t1=e.sent,i=(0,e.t0)(e.t1,3),c=i[0],l=i[1],v=i[2],0!==Object.keys(c).length){e.next=13;break}throw new Error("No pools data found");case 13:for(b=[],f=!0,h=!1,d=void 0,e.prev=15,m=Object.keys(c)[Symbol.iterator]();!(f=(w=m.next()).done);f=!0)k=w.value,(O=s[k])&&O.bribe&&b.push({amm:O.address,tokenA:O.token1.symbol,tokenB:O.token2.symbol,poolType:O.type,bribes:c[k]?c[k].bribes:new u.O(0),bribesData:c[k]?c[k].bribesData:[],liquidity:c[k]?c[k].liquidity:new u.O(0),liquidityTokenA:c[k]?c[k].liquidityTokenA:new u.O(0),liquidityTokenB:c[k]?c[k].liquidityTokenB:new u.O(0),totalVotesCurrent:0===Object.keys(l.totalVotesData).length?new u.O(0):l.totalVotesData[k]?l.totalVotesData[k].votes:new u.O(0),totalVotesPercentageCurrent:0===Object.keys(l.totalVotesData).length?new u.O(0):l.totalVotesData[k]?l.totalVotesData[k].votePercentage:new u.O(0),totalVotesPrevious:0===Object.keys(v.totalVotesData).length?new u.O(0):v.totalVotesData[k]?v.totalVotesData[k].votes:new u.O(0),totalVotesPercentagePrevious:0===Object.keys(v.totalVotesData).length?new u.O(0):v.totalVotesData[k]?v.totalVotesData[k].votePercentage:new u.O(0)});e.next=23;break;case 19:e.prev=19,e.t2=e.catch(15),h=!0,d=e.t2;case 23:e.prev=23,e.prev=24,f||null==m.return||m.return();case 26:if(e.prev=26,!h){e.next=29;break}throw d;case 29:return e.finish(26);case 30:return e.finish(23);case 31:return e.abrupt("return",{success:!0,poolsData:b});case 34:return e.prev=34,e.t3=e.catch(0),console.log(e.t3),e.abrupt("return",{success:!1,poolsData:[],error:e.t3.message});case 38:case"end":return e.stop()}}),e,null,[[0,34],[15,19,23,31],[24,,26,30]])})));return function(t,r){return e.apply(this,arguments)}}()}}]);