(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9963],{1071:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/swapOld",function(){return t(80130)}])},80130:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return R}});var a=t(34051),r=t.n(a),i=t(85893),s=t(45697),c=t.n(s),o=t(67294),u=t(16110),l=t(92170),m=t(86010),f=t(30594),d=t(7736),g=t(97468),h=t(45459),p=t(40049),O=t(62210),k=t(70794),w=t(49373),S=t(72588),T=t(4126),P=t(34362);var b=function(e){(0,O.CG)((function(e){return e.config.tokens}));var n=(0,O.CG)((function(e){return e.tokenPrice.tokenPrice})),t=(0,O.CG)((function(n){return n.userSettings.settings[e.otherProps.walletAddress?e.otherProps.walletAddress:""]?n.userSettings.settings[e.otherProps.walletAddress?e.otherProps.walletAddress:""]:n.userSettings.settings[""]})),a=(0,O.CG)((function(e){return e.config.tokens})),r=(0,O.CG)((function(e){return e.wallet.address})),s=Object.entries(a),c=(0,f.T)(),u=c.tokenIn,l=c.setTokenIn,b=c.tokenOut,L=c.setTokenOut,v=(0,o.useState)(""),I=v[0],y=v[1],A=(0,o.useState)(""),j=A[0],x=A[1],C=(0,o.useState)(!1),R=C[0],E=C[1],F=(0,o.useState)(!1),N=F[0],_=F[1],B=(0,o.useState)(""),G=B[0],M=B[1],W=(0,o.useState)(!1),U=W[0],D=W[1],X=(0,o.useState)("tokenIn"),H=X[0],Q=X[1],Y=(0,o.useState)(""),q=Y[0],V=Y[1],J=(0,o.useState)(!1),Z=J[0],K=J[1],$=(0,o.useState)(Number(t.slippage)),z=$[0],ee=$[1],ne=(0,o.useState)(!1),te=ne[0],ae=ne[1],re=(0,o.useState)(""),ie=re[0],se=re[1],ce=(0,o.useState)(t.multiHop),oe=ce[0],ue=ce[1],le=o.useRef({isLoadingfirst:!1,isLoadingSecond:!1}),me=o.useRef({minimumOut:new k.O(0),minimumTokenOut:[],feePerc:[],isStable:[],path:[],finalFeePerc:new k.O(0),priceImpact:new k.O(0),success:!1,exchangeRate:new k.O(0)}),fe=o.useRef([]),de=o.useRef([]),ge=(0,o.useState)([]),he=ge[0],pe=ge[1],Oe=o.useRef([]),ke=o.useRef([]),we=o.useRef(!1),Se=(0,o.useState)({success:!1,allTokensBalances:{}}),Te=Se[0],Pe=Se[1];(0,o.useEffect)((function(){Pe({success:!1,allTokensBalances:{}}),r?(0,h.b1)(Object.values(a),r).then((function(e){Pe(e)})):Pe({success:!1,allTokensBalances:{}})}),[r,a,te]),(0,o.useEffect)((function(){ee(t.slippage),ue(t.multiHop)}),[e.otherProps.walletAddress,t]),(0,o.useEffect)((function(){0!==Object.keys(b).length&&""!==b.name&&0!==Object.keys(u).length&&""!==u.name&&(n[u.name]||n[b.name]?le.current={isLoadingfirst:!0,isLoadingSecond:!0}:le.current={isLoadingfirst:!1,isLoadingSecond:!1})}),[n]),(0,o.useEffect)((function(){Object.prototype.hasOwnProperty.call(u,"name")&&Object.prototype.hasOwnProperty.call(b,"name")&&""!==u.name&&""!==b.name&&(we.current||""!==I?0!==Number(I)&&(me.current={minimumOut:new k.O(0),minimumTokenOut:[],feePerc:[],isStable:[],path:[],finalFeePerc:new k.O(0),priceImpact:new k.O(0),success:!0,exchangeRate:new k.O(0)}):le.current={isLoadingfirst:!0,isLoadingSecond:!0},(0,w.p2)(u.name,b.name,oe).then((function(e){e&&(le.current={isLoadingfirst:!1,isLoadingSecond:!1},fe.current=e.paths,0!==fe.current.length?(pe(e.paths),Oe.current=e.swapData,se("")):(se(oe?p.h.SWAPROUTER:p.h.SWAPMULTIHOP),pe([]),Oe.current=[],me.current={minimumOut:new k.O(0),minimumTokenOut:[],feePerc:[],isStable:[],path:[],finalFeePerc:new k.O(0),priceImpact:new k.O(0),success:!1,exchangeRate:new k.O(0)},le.current={isLoadingfirst:!1,isLoadingSecond:!1}),""===I&&""===j||(le.current={isLoadingfirst:!1,isLoadingSecond:!1},!we.current&&x(""),!we.current&&be(I,"tokenIn")),(0,w.p2)(b.name,u.name,oe).then((function(e){de.current=e.paths,0!==de.current.length?(pe(e.paths),ke.current=e.swapData,se("")):(pe([]),ke.current=[])})))})))}),[u,b,H,oe,n,we.current,te]);var be=function(e,t){we.current=!1;var r=1;if("."!=e){if(0!==Object.keys(b).length?le.current={isLoadingSecond:!0,isLoadingfirst:!1}:me.current={minimumOut:new k.O(0),minimumTokenOut:[],feePerc:[],isStable:[],path:[],finalFeePerc:new k.O(0),priceImpact:new k.O(0),success:!1,exchangeRate:new k.O(0)},""===e||isNaN(Number(e))||0!==Object.keys(b).length&&0===fe.current.length)y(""),x(""),me.current={minimumOut:new k.O(0),minimumTokenOut:[],feePerc:[],isStable:[],path:[],finalFeePerc:new k.O(0),priceImpact:new k.O(0),success:!1,exchangeRate:new k.O(0)},le.current={isLoadingSecond:!1,isLoadingfirst:!1};else if(0===Number(e))y(e.toString().trim()),me.current={minimumOut:new k.O(0),minimumTokenOut:[],feePerc:[],isStable:[],path:[],finalFeePerc:new k.O(0),priceImpact:new k.O(0),success:!1,exchangeRate:new k.O(0)},le.current={isLoadingSecond:!1,isLoadingfirst:!1},x(e.toString().trim());else if("tokenIn"===t){var i;y(e.toString().trim());var s=new k.O(e).decimalPlaces();if(null!==e&&null!==s&&new k.O(s).isGreaterThan(null===(i=a[u.name])||void 0===i?void 0:i.decimals)&&(r=0,se("The Precision of ".concat((0,P.Xf)(u.name)," token cant be greater than ").concat(a[u.name].decimals," decimals"))),0!==Object.keys(b).length){le.current={isLoadingSecond:!0,isLoadingfirst:!1};var c=(0,S.Sq)(fe.current,new k.O(e),new k.O(z),Oe.current,n);le.current={isLoadingSecond:!1,isLoadingfirst:!1},me.current={minimumOut:c.finalMinimumTokenOut,minimumTokenOut:c.minimumTokenOut,feePerc:c.feePerc,isStable:c.isStable,path:c.path,finalFeePerc:c.finalFeePerc,priceImpact:c.finalPriceImpact,success:!0,exchangeRate:c.exchangeRate},c.tokenOutAmount.isLessThan(0)&&(r=0,se(p.h.INSUFFICIENT_LIQUIDITY)),x(c.tokenOutAmount.isLessThan(0)?0:c.tokenOutAmount.toString().trim())}}else if("tokenOut"===t){x(e.toString().trim());var o=new k.O(e).decimalPlaces();if(null!==e&&null!==o&&new k.O(o).isGreaterThan(a[b.name].decimals)&&(r=0,se("The Precision of ".concat((0,P.Xf)(b.name)," token cant be greater than ").concat(a[b.name].decimals," decimals"))),0!==Object.keys(u).length){le.current={isLoadingfirst:!0,isLoadingSecond:!1};var l=(0,S.vh)(de.current,new k.O(e),new k.O(z),ke.current,n,fe.current,Oe.current);le.current={isLoadingSecond:!1,isLoadingfirst:!1},me.current={minimumOut:l.finalMinimumTokenOut,minimumTokenOut:l.minimumTokenOut,feePerc:l.feePerc,isStable:l.isStable,path:l.path,finalFeePerc:l.finalFeePerc,priceImpact:l.finalPriceImpact,success:!0,exchangeRate:l.exchangeRate},l.tokenOutAmount.isLessThan(0)&&(r=0,se(p.h.INSUFFICIENT_LIQUIDITY)),y(l.tokenOutAmount.isLessThan(0)?0:l.tokenOutAmount.toString().trim())}}1===r&&se("")}else"tokenIn"===t?y("0."):x("0.")},Le=function(){K(!1),V("")},ve=(0,o.useMemo)((function(){return s.map((function(e){var n,t;return{name:e[0],image:"/assets/Tokens/".concat(null===(n=e[1])||void 0===n?void 0:n.symbol,".png"),chainType:null===(t=e[1])||void 0===t?void 0:t.originChain,address:e[1].address}}))}),[a]);return(0,o.useEffect)((function(){Te.success&&0!==Object.keys(Te.allTokensBalances).length&&ve.sort((function(e,n){var t,a,r,i;return Number((null===(t=Te.allTokensBalances[n.name])||void 0===t?void 0:t.balance)?null===(a=Te.allTokensBalances[n.name])||void 0===a?void 0:a.balance:0)-Number((null===(r=Te.allTokensBalances[e.name])||void 0===r?void 0:r.balance)?null===(i=Te.allTokensBalances[e.name])||void 0===i?void 0:i.balance:0)}))}),[ve,Te.allTokensBalances]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:(0,m.default)("bg-card-500 md:border border-y border-text-800 mt-[70px] lg:mt-[75px] md:rounded-3xl  text-white lg:w-640 pt-5 pb-2 mx-auto fade-in"),children:(0,i.jsx)(g.Z,{walletAddress:e.otherProps.walletAddress,firstTokenAmount:I,secondTokenAmount:j,connectWallet:e.otherProps.connectWallet,tokenIn:u,tokenOut:b,tokens:ve,handleTokenType:function(e){ae(!1),K(!0),Q(e)},setSlippage:ee,slippage:z,handleClose:Le,changeTokenLocation:function(){var e=j;y(e.toString()),we.current=!0,x(""),Object.prototype.hasOwnProperty.call(u,"name")&&Object.prototype.hasOwnProperty.call(b,"name")&&""!==u.name&&""!==b.name&&(le.current={isLoadingfirst:!1,isLoadingSecond:!0}),b.name&&u.name?(l({name:b.name,image:b.image}),L({name:u.name,image:u.image}),e>0?setTimeout((function(){me.current={minimumOut:new k.O(0),minimumTokenOut:[],feePerc:[],isStable:[],path:[],finalFeePerc:new k.O(0),priceImpact:new k.O(0),success:!0,exchangeRate:new k.O(0)},pe([]);var t=(0,S.Sq)(fe.current,new k.O(e),new k.O(z),Oe.current,n);me.current={minimumOut:t.finalMinimumTokenOut,minimumTokenOut:t.minimumTokenOut,feePerc:t.feePerc,isStable:t.isStable,path:t.path,finalFeePerc:t.finalFeePerc,priceImpact:t.finalPriceImpact,success:!0,exchangeRate:t.exchangeRate},t.tokenOutAmount.isLessThan(0)?se(p.h.INSUFFICIENT_LIQUIDITY):se(""),x(t.tokenOutAmount.isLessThan(0)?0:t.tokenOutAmount.toString()),le.current={isLoadingSecond:!1,isLoadingfirst:!1},x(t.tokenOutAmount.isLessThan(0)?0:t.tokenOutAmount.toString())}),2e3):(x(0),le.current={isLoadingSecond:!1,isLoadingfirst:!1})):0===Object.keys(b).length?(le.current={isLoadingfirst:!1,isLoadingSecond:!1},L({name:u.name,image:u.image}),l({})):0===Object.keys(u).length&&(le.current={isLoadingfirst:!1,isLoadingSecond:!1},l({name:b.name,image:b.image}),L({}))},setSecondTokenAmount:x,setFirstTokenAmount:y,handleSwapTokenInput:be,setTokenIn:l,setTokenOut:L,setTokenType:Q,tokenPrice:n,recepient:G,setRecepient:M,setShowConfirmSwap:_,showConfirmSwap:N,setV3ShowConfirmSwap:_,v3ShowConfirmSwap:N,setShowConfirmTransaction:E,showConfirmTransaction:R,setShowTransactionSubmitModal:D,showTransactionSubmitModal:U,loading:le.current,resetAllValues:function(){y(""),x(""),be("","tokenIn"),me.current={minimumOut:new k.O(0),minimumTokenOut:[],feePerc:[],isStable:[],path:[],finalFeePerc:new k.O(0),priceImpact:new k.O(0),success:!1,exchangeRate:new k.O(0)}},routeDetails:me.current,allPath:he,setErrorMessage:se,errorMessage:ie,setEnableMultiHop:ue,enableMultiHop:oe,setBalanceUpdate:ae,isSwitchClicked:we.current,allBalance:Te})}),(0,i.jsx)(d.Z,{tokens:ve.filter((function(e){return e.name.toLowerCase()!==T.kc.KODEX.toLowerCase()&&e.name.toLowerCase()!==T.kc.WRAP.toLowerCase()})),show:Z,isSuccess:Te.success,isLoading:Te.success,allBalance:Te.allTokensBalances,selectToken:function(e){we.current=!1,"tokenOut"!==H&&"tokenIn"!==H||""===I||(x(""),le.current={isLoadingfirst:!1,isLoadingSecond:!0}),"tokenIn"===H?l({name:e.name,image:e.image}):L({name:e.name,image:e.image}),Le()},onhide:Le,tokenIn:u,tokenOut:b,tokenType:H,searchQuery:q,setSearchQuery:V})]})},L=t(52767),v=t(75528),I=t(12619),y=t(11802),A=t(93213),j=t(8292);function x(e,n,t,a,r,i,s){try{var c=e[i](s),o=c.value}catch(u){return void t(u)}c.done?n(o):Promise.resolve(o).then(a,r)}var C=function(){var e=(0,O.CG)((function(e){return e.wallet.address})),n=(0,O.CG)((function(e){return e.config.tokens})),t=(0,O.CG)((function(e){return e.pools.totalVotingPowerError})),a=(0,O.CG)((function(e){return e.epoch})).epochFetchError,s=(0,O.CG)((function(e){return e.tokenPrice.tokenPrice})),c=(0,O.CG)((function(e){return e.config.AMMs})),m=(0,o.useRef)(!0),f=(0,o.useRef)(!0),d=(0,u.I0)();(0,o.useEffect)((function(){d((0,j.mg)()),d((0,v.iE)())}),[]),(0,o.useEffect)((function(){a&&d((0,I.jJ)())}),[a]),(0,L.Y)((function(){d((0,I.jJ)())}),6e4),(0,o.useEffect)((function(){e&&d((0,y.j)())}),[e]),(0,o.useEffect)((function(){e&&t&&d((0,y.j)())}),[t]),(0,o.useEffect)((function(){m.current?m.current=!1:0!==Object.keys(n).length&&d((0,A.jq)())}),[n]),(0,o.useEffect)((function(){f.current?f.current=!1:0!==Object.keys(s).length&&d((0,A.GR)(s))}),[s]),(0,o.useEffect)((function(){0!==Object.keys(c).length&&d((0,v.Yb)())}),[c]);var g=function(){var n,t=(n=r().mark((function n(){return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e){n.next=2;break}return n.abrupt("return",d((0,j.Xp)()));case 2:case"end":return n.stop()}}),n)})),function(){var e=this,t=arguments;return new Promise((function(a,r){var i=n.apply(e,t);function s(e){x(i,a,r,s,c,"next",e)}function c(e){x(i,a,r,s,c,"throw",e)}s(void 0)}))});return function(){return t.apply(this,arguments)}}(),h={connectWallet:function(){return d((0,j.A$)())},disconnectWallet:g,walletAddress:e};return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(l.t,{makeTopBarScroll:!0,children:(0,i.jsx)(b,{otherProps:h})})})};C.propTypes={connectWallet:c().any,disconnectWallet:c().any,fetchWalletAddress:c().any,userAddress:c().any};var R=C}},function(e){e.O(0,[2361,9774,2888,179],(function(){return n=1071,e(e.s=n);var n}));var n=e.O();_N_E=n}]);